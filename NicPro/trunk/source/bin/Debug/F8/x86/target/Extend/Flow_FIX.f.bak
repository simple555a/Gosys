fblock FLOW_FIX; //带小信号切除的流量换算模块
uuid{67aa-7b74-1378-8bdc};
var	
	IN:float; in;
	Pmin:float;in;
	Pmax:float;in;
	Tmin:float;in;
	Tmax:float;in;
	Kt:float;in;	//小信号切除比（%）
	OUT:float; out;
implementation
static float s;
void main()
{	
	s = IN * (Pmax - Pmin) + Pmin;
	if(s < 0){
		s = 0;
	}
	OUT = sqrt(s) * (Tmax - Tmin) / sqrt(Pmax - Pmin); 
	if(OUT < (Tmin + (Tmax - Tmin) * Kt)){
		OUT = 0;
	}
	if(OUT > Tmax){
		OUT = Tmax;
	}
}